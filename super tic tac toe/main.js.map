{
  "version": 3,
  "sources": ["../src/main.ts"],
  "sourcesContent": ["var canvas: HTMLCanvasElement;\nvar context: CanvasRenderingContext2D;\n\n// system variables\nvar last_tick_t = 0;\nvar width: number;\nvar height: number;\nvar keyStates: Set<string> = new Set();\nvar mouseX = 0;\nvar mouseY = 0;\n\n// game variables\nvar innerFields: number[][][][];\nvar outerField: number[][];\nvar currentPlayer: number;\nvar fieldRestrictionX: number;\nvar fieldRestrictionY: number;\nvar won: number;\n\nfunction initialize() {\n    won = 0;\n    fieldRestrictionX = -1;\n    fieldRestrictionY = -1;\n    currentPlayer = 1;\n    innerFields = [];\n    outerField = [];\n    for(let x=0; x<3; x++) {\n        innerFields[x] = [];\n        outerField[x] = [];\n        for(let y=0; y<3; y++) {\n            innerFields[x][y] = [];\n            outerField[x][y] = 0;\n            for(let i=0; i<3; i++) {\n                innerFields[x][y][i] = []\n                for(let j=0; j<3; j++) {\n                    innerFields[x][y][i][j] = 0;\n                }\n            }\n        }\n    }\n}\n\nfunction drawTicTacToeField(field: number[][]) {\n    context.beginPath();\n    context.moveTo(100, 0);\n    context.lineTo(100,300);\n    context.moveTo(200, 0);\n    context.lineTo(200,300);\n    context.moveTo(0, 100);\n    context.lineTo(300, 100);\n    context.moveTo(0, 200);\n    context.lineTo(300,200);\n    for(let x=0; x<3; x++) {\n        for(let y=0; y<3; y++) {\n            if(field[x][y] == 1) {\n                context.moveTo(80+100*x, 50+100*y);\n                context.arc(50+100*x, 50+100*y, 30,0,2*Math.PI);\n            }\n            if(field[x][y] == 2) {\n                context.moveTo(20+100*x, 20+100*y);\n                context.lineTo(80+100*x, 80+100*y);\n                context.moveTo(20+100*x, 80+100*y);\n                context.lineTo(80+100*x, 20+100*y);\n            }\n        }\n    }\n    context.stroke();\n}\n\nfunction draw() {\n    context.resetTransform();\n    context.clearRect(0, 0, 900, 900);\n    // select color\n    context.fillStyle = \"black\";\n\n    let testField = [[0,1,2],[0,1,0],[1,2,0]];\n    for(let x=0; x<3; x++) {\n        for(let y=0; y<3; y++) {\n            if(outerField[x][y] == -1) {\n                context.fillStyle = \"light grey\";\n                context.fillRect(0, 0, 300, 300);\n                context.fillStyle = \"black\";\n            }\n            drawTicTacToeField(innerFields[x][y]);\n            context.translate(0,300);\n        }\n        context.translate(300,-900);\n    }\n    context.resetTransform();\n    context.scale(3,3);\n    drawTicTacToeField(outerField);\n    context.strokeStyle = \"red\";\n    if(fieldRestrictionX != -1) {\n        context.strokeRect(fieldRestrictionX*100, fieldRestrictionY*100, 100, 100);\n    } else {\n        context.strokeRect(0, 0, 300, 300);\n    }\n    context.strokeStyle = \"black\";\n    context.scale(3,3);\n    context.beginPath();\n    if(won == 1) {\n        context.moveTo(80, 50);\n        context.arc(50, 50, 30,0,2*Math.PI);\n    }\n    if(won == 2) {\n        context.moveTo(20, 20);\n        context.lineTo(80, 80);\n        context.moveTo(20, 80);\n        context.lineTo(80, 20);\n    }\n    context.stroke();\n}\n/*\nfunction resized() {\n    width = window.innerWidth;\n    height = window.innerHeight;\n    canvas.width = width;\n    canvas.height = height;\n    draw();\n}\n*/\n\nfunction key(e: KeyboardEvent) {\n    switch (e.type) {\n        case \"keydown\":\n            keyStates.add(e.key);\n            if(e.key == \"r\") {\n                initialize();\n            }\n            break;\n        case \"keyup\":\n            keyStates.delete(e.key);\n            break;\n        default:\n            console.warn(\"Wut?\");\n    }\n}\n\nfunction checkWin(field: number[][]) {\n    if(field[0][0] != 0 && field[0][0] == field[0][1] && field[0][1] == field[0][2]) {\n        return field[0][0];\n    }\n    if(field[1][0] != 0 && field[1][0] == field[1][1] && field[1][1] == field[1][2]) {\n        return field[1][0];\n    }\n    if(field[2][0] != 0 && field[2][0] == field[2][1] && field[2][1] == field[2][2]) {\n        return field[2][0];\n    }\n\n    if(field[0][0] != 0 && field[0][0] == field[1][0] && field[1][0] == field[2][0]) {\n        return field[0][0];\n    }\n    if(field[0][1] != 0 && field[0][1] == field[1][1] && field[1][1] == field[2][1]) {\n        return field[0][1];\n    }\n    if(field[0][2] != 0 && field[0][2] == field[1][2] && field[1][2] == field[2][2]) {\n        return field[0][2];\n    }\n\n    if(field[0][0] != 0 && field[0][0] == field[1][1] && field[1][1] == field[2][2]) {\n        return field[0][0];\n    }\n    if(field[2][0] != 0 && field[2][0] == field[1][1] && field[1][1] == field[0][2]) {\n        return field[2][0];\n    }\n    if(field[0][0] != 0 && field[0][1] != 0 && field[0][2] != 0\n        && field[1][0] != 0 && field[1][1] != 0 && field[1][2] != 0\n        && field[2][0] != 0 && field[2][1] != 0 && field[2][2] != 0) {\n            return -1;\n    }\n    return 0;\n}\n\nfunction click(e: MouseEvent) {\n    let x = Math.floor(e.offsetX/300);\n    let y = Math.floor(e.offsetY/300);\n    let innerX = Math.floor((e.offsetX/300-x)*3);\n    let innerY = Math.floor((e.offsetY/300-y)*3);\n    if(won == 0 && outerField[x][y] == 0 && innerFields[x][y][innerX][innerY] == 0\n        && (fieldRestrictionX == -1 || (x == fieldRestrictionX && y == fieldRestrictionY))) {\n        innerFields[x][y][innerX][innerY] = currentPlayer;\n        currentPlayer = 3-currentPlayer;\n        let win = checkWin(innerFields[x][y]);\n        if(win > 0) {\n            outerField[x][y] = win;\n            win = checkWin(outerField);\n            if(win > 0) {\n                won = win;\n            }\n        }\n        if(outerField[innerX][innerY] == 0) {\n            fieldRestrictionX = innerX;\n            fieldRestrictionY = innerY;\n        } else {\n            fieldRestrictionX = -1;\n            fieldRestrictionY = -1;\n        }\n    }\n    draw();\n}\n\nfunction restart() {\n    initialize();\n    draw();\n}\n\nfunction mousemove(e: MouseEvent) {\n    mouseX = e.offsetX;\n    mouseY = e.offsetY;\n}\n\nfunction main() {\n    initialize();\n    canvas = document.getElementById(\"canvas\") as HTMLCanvasElement;\n    context = canvas.getContext(\"2d\")!;\n    window.addEventListener(\"keydown\", key);\n    window.addEventListener(\"keyup\", key);\n    //window.addEventListener(\"resize\", resized);\n    canvas.addEventListener(\"click\", click);\n    canvas.addEventListener(\"mousemove\", mousemove);\n    let restartbutton = document.getElementById(\"newgame\");\n    restartbutton.addEventListener(\"click\", restart);\n    //resized();\n    draw();\n}\n\n\nmain();"],
  "mappings": "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",
  "names": []
}
