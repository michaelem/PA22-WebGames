(()=>{var d,n,i,r,m={spawn_delay:5,max_rockets:5,reset_delay:.5,expl_duration:.1},l,w=0,f,c,h,u,s=new Set;function y(t){return(t+8*Math.PI)%(2*Math.PI)}function g(t,e,a){return t=y(t),e=y(e),a=y(a),t===e?a===t:t<e?t<=a&&a<e:0<=a&&a<e||t<=a&&a<2*Math.PI}function P(){c=performance.now(),r=[],l=[],i={x:100,y:100,a:0,v:200,w:Math.PI*1.3,size:20,hitpoints:3},v()}function v(){let t={x:h/2,y:u/2},e=Math.hypot(h,u)/2,a=Math.random()*2*Math.PI,o={x:t.x+1.1*e*Math.cos(a),y:t.y+1.1*e*Math.sin(a)};r.push(new M(o.x,o.y,(a+Math.PI/2)%(2*Math.PI)))}var M=class{constructor(e,a,o){this.w=Math.PI/2;this.size=10;this.exploded=!1;this.x=e,this.y=a,this.a=o,this.v=300+400*Math.random()}tick(e,a){this.x+=this.v*Math.cos(this.a)*e,this.y+=this.v*Math.sin(this.a)*e;let o=Math.atan2(a.y-this.y,a.x-this.x);g(this.a,this.a+Math.PI,o)?this.a+=this.w*e:this.a-=this.w*e,this.a%=2*Math.PI}};function z(){n.lineCap="round",n.resetTransform(),n.fillStyle="black",n.fillRect(0,0,h,u),n.strokeStyle="white",n.fillStyle="white",n.lineWidth=2,n.translate(i.x,i.y),n.rotate(i.a),n.beginPath(),n.moveTo(i.size/2,0),n.lineTo(-i.size/2,+i.size/2),n.lineTo(-i.size/4,0),n.lineTo(-i.size/2,-i.size/2),n.lineTo(i.size/2,0),n.fill(),n.lineWidth=4;for(let t of r)n.resetTransform(),n.translate(t.x,t.y),n.rotate(t.a),n.beginPath(),n.moveTo(0,0),n.lineTo(-t.size,0),n.stroke();n.resetTransform();for(let t of l)n.fillStyle="red",n.beginPath(),n.arc(t.pos.x,t.pos.y,50,0,2*Math.PI),n.fill()}function x(t,e=1){l.push({pos:t,t0:f})}function _(t){i.x+=i.v*Math.cos(i.a)*t,i.y+=i.v*Math.sin(i.a)*t,(s.has("ArrowLeft")||s.has("a"))&&(i.a-=i.w*t,i.a%=2*Math.PI),(s.has("ArrowRight")||s.has("d"))&&(i.a+=i.w*t);for(let e of r)e.tick(t,i);for(let e of r)!e.exploded&&Math.hypot(i.x-e.x,i.y-e.y)<i.size&&(i.hitpoints--,e.exploded=!0,x(i,3));for(let e of r)for(let a of r)e!=a&&!e.exploded&&!a.exploded&&Math.hypot(e.x-a.x,e.y-a.y)<(e.size+a.size)/2&&(e.exploded=!0,a.exploded=!0,x(e));r=r.filter(e=>!e.exploded),r.length<m.max_rockets&&f/m.spawn_delay>r.length&&v(),l=l.filter(e=>e.t0+m.expl_duration>f)}function k(t){let e=t-w;w=t,f=(t-c)/1e3,_(e/1e3),z(),window.requestAnimationFrame(k)}function p(){h=window.innerWidth,u=window.innerHeight,d.width=h,d.height=u}function b(t){switch(t.type){case"keydown":s.add(t.key);break;case"keyup":s.delete(t.key);break}}function I(){d=document.getElementById("canvas"),n=d.getContext("2d"),window.addEventListener("keydown",b),window.addEventListener("keyup",b),window.addEventListener("resize",p),p(),P(),k(c)}I();})();
//# sourceMappingURL=main.js.map
